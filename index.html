<!-- Needed to add this for live server to auto update -->
<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amnesia Restored</title>
  <!-- CSS styles -->
  <link id="styles" rel="stylesheet" type="text/css" href="css/dev.css">
  <link rel="stylesheet" href="scr/leaflet.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@700&family=Work+Sans&display=swap" rel="stylesheet">
  
  <!-- Addtional Scripts -->
  <script src="scr/leaflet.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>
  <div class="game">
    <!-- Game content -->
    <div class="sidebar">
      <button id="invbutton">INVENTORY</button>
      <button id="addrbutton">ADDRESS BOOK</button>
      <button id="mapbutton">MAP</button>
    </div>
    
    <div id="container-o">
      <div id="currroom">CURRENT ROOM</div>
      <div id="output"></div>
      <!-- Player input -->
      <div class="input"><span class="ml-2" id="arrow">> </span><input id="input" autofocus spellcheck="false" autocomplete="off"></div>

      <div class="statusbar">
        <div class="nested" id="hunger">
          <div>img</div>
          <div>HUNGER</div>
        </div>
        <div class="nested" id="fatigue">
          <div>img</div>
          <div>FATIGUE</div>
        </div>
        <div id="money">MONEY</div>
        <div id="time">TIME</div>
      </div>
    </div>
    
    <div class="nested" id="menubutton">
      <button>MENU</button>
    </div>

    <div id="address">ADDRESS</div>
    <div id="inv">INV
      <div class="inventorygrid">
        <div>1</div>
        <div>2</div>
        <div>3</div>
        <div>4</div>
        <div>5</div>
        <div>6</div>
        <div>7</div>
        <div>8</div>
        <div>9</div>
        <div>10</div>
        <div>11</div>
        <div>12</div>
      </div>
    </div>

    <div id="map" style="width: 70%; height: 50%; background: #32302f;"></div>
  </div>

  <div id="dialPad">
    <button id="close">x</button>
    <button id="howTo">i</button>
    <div id="dialKeys">
      <button name="number" value="1" id="1key" onclick='numdialButton(this.id)'>1</button>
      <button name="number" value="2" id="2key" onclick='numdialButton(this.id)'>2</button>
      <button name="number" value="3" id="3key" onclick='numdialButton(this.id)'>3</button>
      <button name="number" value="4" id="4key" onclick='numdialButton(this.id)'>4</button>
      <button name="number" value="5" id="5key" onclick='numdialButton(this.id)'>5</button>
      <button name="number" value="6" id="6key" onclick='numdialButton(this.id)'>6</button>
      <button name="number" value="7" id="7key" onclick='numdialButton(this.id)'>7</button>
      <button name="number" value="8" id="8key" onclick='numdialButton(this.id)'>8</button>
      <button name="number" value="9" id="9key" onclick='numdialButton(this.id)'>9</button>
      <button name="number" value="delete" id="deletekey" onclick='deleteNum()'>Delete</button>
      <button name="number" value="0" id="0key" onclick='numdialButton(this.id)'>0</button>
      <button name="number" value="enter" id="enterkey" onclick='enterNum()'>Enter</button>
    </div>
  </div>
  
  
  <script type="text/javascript">
//Creating the Map
  //var map = L.map('map').setView([0, 0], 0);
  var map = L.map('map', {center:[29.0, 76.776695], zoom:2});
  map.invalidateSize();
  setTimeout(function(){ map.invalidateSize(true)}, 300);
  L.tileLayer('map/{z}/{x}/{y}.png', {
    continuousWorld: false,
    noWrap: true,	
    minZoom: 1,
    maxZoom: 5,
  }).addTo(map);
//Coordinate Finder
  var marker = L.marker([0, 0], {
    draggable: true,
  }).addTo(map);
  marker.bindPopup('LatLng Marker').openPopup();
  marker.on('dragend', function(e) {
    marker.getPopup().setContent(marker.getLatLng().toString()).openOn(map);
  });
//Markers


//MAP BUTTON
const targetDiv = document.getElementById("map");
  const btn = document.getElementById("mapbutton");
  btn.onclick = function () {
  if (targetDiv.style.display !== "none") {
    targetDiv.style.display = "none";
  } else {
    targetDiv.style.display = "block";
    map.invalidateSize();
  }
};

//INVENTORY BUTTON
const invDiv = document.getElementById("inv");
  const invBtn = document.getElementById("invbutton");
  invBtn.onclick = function () {
  if (invDiv.style.display !== "none") {
    invDiv.style.display = "none";
  } else {
    invDiv.style.display = "block";
  }
};

//ADDRESS BUTTON
const addrDiv = document.getElementById("address");
  const addrBtn = document.getElementById("addrbutton");
  addrBtn.onclick = function () {
  if (addrDiv.style.display !== "none") {
    addrDiv.style.display = "none";
  } else {
    addrDiv.style.display = "block";
  }
};

// DIAL 
let numdialButton = (clicked_id) => {
  let x = document.getElementById(clicked_id).innerHTML;
  document.getElementById("input").value = document.getElementById("input").value + x;
}

let numdialKey = () => {
  document.getElementById("input").value = document.getElementById("input").value + number;
}

function enterBtnClick () {
  e = $.Event('keyup');
  e.keyCode= 13; // enter
  $('input').trigger(e);
  applyInput();
  console.log('triggered');
}

let enterNum = () => {
  const enterButton = document.getElementById("enterkey");
  enterButton.addEventListener("click", enterBtnClick());
  document.getElementById("dialPad").style.display = "none";
}
       
let deleteNum = () => {
  document.getElementById("input").value = document.getElementById("input").value.slice(0, -1);
}

</script>



  <!-- Include game engine -->
  <!-- Be sure to load in dependencies first -->
  <script src="scr/text-engine/parser.js"></script>
  <script src="scr/text-engine/init.js"></script>
  <script src="scr/text-engine/pcommand.js"></script>
  <script src="scr/text-engine/internalfunc.js"></script>
  <script src='scr/text-engine/playercharacter.js'></script>

  <!-- Include game data ('disk') -->
  <script src="scr/text-engine/game-disks/streets.js"></script>

<!-- Load disk into engine -->
<script>loadDisk(streets);</script>
</body>
